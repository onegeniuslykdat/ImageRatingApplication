@page "/ratings"

@using ImageRatingPortal.Components
@using ImageRatingPortal.Data;
@using Microsoft.AspNetCore.Components.Server.ProtectedBrowserStorage

@inject NavigationManager navManager
@inject ProtectedLocalStorage localStorage

<PageTitle>Ratings</PageTitle>

<h1 class="text-center">Rate New Image</h1>

<hr/>

@if (FindImageNotSeen <= 0)
{
    <ThankYou />
}
else
{
    <ImageCard />
}

<br/>

@if(hasRatedAnyImage)
{
    <a href="/userimagegridhistory" class="btn btn-secondary" style="width:100%">Your History</a>
}


@code {

    public int FindImageNotSeen { get; set; } = 0;

    public bool hasRatedAnyImage { get; set; } = true;

    protected override async Task OnInitializedAsync()
    {
        // Check for User Details
        string? useridString = (await localStorage.GetAsync<string>("userid")).Value;
        if (string.IsNullOrWhiteSpace(useridString))
        {
            navManager.NavigateTo("/");
        }
        int userid = int.Parse(useridString);

        // Check if there are images the user has not seen

        // Load Image Details

        //return base.OnInitializedAsync();
    }
}
